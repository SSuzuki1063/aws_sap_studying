<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Systems Manager Run Command を会社経営で理解しよう</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.8;
            font-size: 16px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-size: 3.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.4em;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            animation: fadeInUp 1s ease-out;
        }

        .intro-analogy {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .intro-analogy h2 {
            color: #d63384;
            font-size: 2em;
            margin-bottom: 15px;
        }

        .analogy-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .analogy-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .analogy-card:hover {
            transform: translateY(-10px);
            border-color: #667eea;
        }

        .analogy-icon {
            font-size: 4em;
            margin-bottom: 20px;
            display: block;
        }

        .comparison-table {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .comparison-side {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .everyday-side {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .aws-side {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .simple-diagram {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            position: relative;
        }

        .command-flow {
            display: flex;
            flex-direction: column;
            gap: 40px;
            margin: 30px 0;
        }

        .flow-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            position: relative;
        }

        .center-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            min-width: 300px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            position: relative;
            z-index: 10;
        }

        .branch-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            width: 100%;
        }

        .branch-item {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .branch-item:hover {
            transform: scale(1.05);
            border-color: #4facfe;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .branch-item.tokyo {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .branch-item.osaka {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .branch-item.nagoya {
            background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);
        }

        .connection-lines {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            z-index: 1;
            animation: dataFlow 3s infinite;
        }

        .step-by-step {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .step-item {
            background: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
        }

        .step-item:hover {
            transform: translateX(10px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .step-number {
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5em;
            flex-shrink: 0;
        }

        .step-content h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .faq-section {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 30px;
            border-radius: 15px;
        }

        .faq-item {
            background: white;
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .faq-question {
            background: #667eea;
            color: white;
            padding: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s ease;
        }

        .faq-question:hover {
            background: #5a6fd8;
        }

        .faq-answer {
            padding: 20px;
            background: white;
            border-top: 2px solid #f0f0f0;
            display: none;
        }

        .highlight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .benefit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .benefit-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .benefit-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .command-examples {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .command-card {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .command-code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }

        .result-box {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes dataFlow {
            0%, 100% {
                opacity: 1;
                transform: scaleX(1);
            }
            50% {
                opacity: 0.7;
                transform: scaleX(1.1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .pulsing {
            animation: pulse 2s infinite;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5em;
            }
            
            .comparison-table {
                grid-template-columns: 1fr;
            }
            
            .flow-row {
                flex-direction: column;
            }
            
            .branch-items {
                grid-template-columns: 1fr;
            }
            
            .step-item {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🏢 AWS Systems Manager Run Command</h1>
            <p>会社経営で理解する一斉指示システム</p>
            <div class="intro-analogy">
                <h2>👨‍💼 本社 ↔️ 📋 一斉指示 ↔️ 🏢 各支店</h2>
                <p>AWS Run Commandを、身近な会社の支店管理システムで例えて分かりやすく説明します！</p>
            </div>
        </header>

        <div class="section">
            <h2>🤔 まず、Run Commandって何？</h2>
            <div class="highlight-box">
                <h3>📝 簡単に言うと...</h3>
                <p style="font-size: 1.2em; margin-top: 15px;">
                    <strong>会社の本社</strong>から<strong>複数の支店</strong>に、
                    <strong>同じ作業指示</strong>を一斉に送って実行させる仕組みです
                </p>
            </div>

            <div class="comparison-table">
                <div class="comparison-side everyday-side">
                    <h3>🏢 日常の会社経営</h3>
                    <div style="font-size: 1.1em; margin-top: 15px;">
                        <p><strong>本社の社長</strong> が <strong>全支店</strong> に<br>
                        「新しいセキュリティソフトを<br>全PCにインストールして」</p>
                        <br>
                        <p>📞 電話で一つずつ連絡は大変...<br>
                        📧 <strong>一斉メール</strong>で指示を送ろう！</p>
                    </div>
                </div>
                <div class="comparison-side aws-side">
                    <h3>☁️ AWSの世界</h3>
                    <div style="font-size: 1.1em; margin-top: 15px;">
                        <p><strong>管理者</strong> が <strong>複数のEC2</strong> に<br>
                        「新しいソフトウェアを<br>全サーバーにインストールして」</p>
                        <br>
                        <p>💻 一台ずつSSH接続は大変...<br>
                        🚀 <strong>Run Command</strong>で一斉実行！</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🏢 主要な構成要素を会社で理解</h2>
            <div class="analogy-cards">
                <div class="analogy-card">
                    <div class="analogy-icon">👨‍💼</div>
                    <h3>Run Command<br>= 本社の管理者</h3>
                    <p><strong>指示を出す人</strong>です。<br>
                    会社の社長や管理者のように、<br>
                    複数の支店に<strong>同じ作業指示</strong>を一斉に送ります。</p>
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>特徴:</strong> 一度の操作で複数対象に実行<br>
                        <strong>場所:</strong> AWSコンソールやCLIから
                    </div>
                </div>

                <div class="analogy-card">
                    <div class="analogy-icon">🏢</div>
                    <h3>EC2インスタンス<br>= 各支店</h3>
                    <p><strong>指示を受ける側</strong>です。<br>
                    東京支店、大阪支店、名古屋支店のように、<br>
                    それぞれが<strong>独立した作業場所</strong>を持っています。</p>
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>役割:</strong> 指示された作業を実行<br>
                        <strong>状態:</strong> 24時間稼働中
                    </div>
                </div>

                <div class="analogy-card">
                    <div class="analogy-icon">📱</div>
                    <h3>SSMエージェント<br>= 各支店の連絡担当者</h3>
                    <p><strong>連絡を受ける専門スタッフ</strong>です。<br>
                    本社からの指示を受け取って、<br>
                    支店内で<strong>実際の作業を実行</strong>します。</p>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>必要条件:</strong> 各EC2に事前インストール<br>
                        <strong>機能:</strong> 自動で本社と通信
                    </div>
                </div>

                <div class="analogy-card">
                    <div class="analogy-icon">📋</div>
                    <h3>Document<br>= 作業マニュアル</h3>
                    <p><strong>具体的な作業手順書</strong>です。<br>
                    「ソフトウェアインストール手順」や<br>
                    「システム再起動手順」など、<br>
                    <strong>標準化された作業内容</strong>が記載されています。</p>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>種類:</strong> AWS提供 + カスタム作成<br>
                        <strong>例:</strong> AWS-RunShellScript
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🚀 実際の指示の流れを見てみよう</h2>
            <div class="simple-diagram">
                <div class="command-flow">
                    <div class="flow-row">
                        <div class="center-item pulsing">
                            <div style="font-size: 3em; margin-bottom: 15px;">👨‍💼</div>
                            <h3>本社の管理者</h3>
                            <p><strong>Run Command実行</strong></p>
                            <small>「全支店で同じ作業をして！」</small>
                        </div>
                    </div>
                    
                    <div style="text-align: center; font-size: 2em; color: #667eea;">⬇️</div>
                    <div style="text-align: center; font-weight: bold; color: #667eea;">一斉指示送信</div>
                    <div style="text-align: center; font-size: 2em; color: #667eea;">⬇️</div>
                    
                    <div class="flow-row">
                        <div class="branch-items">
                            <div class="branch-item tokyo">
                                <div style="font-size: 2.5em; margin-bottom: 10px;">🏢</div>
                                <h4>東京支店</h4>
                                <p><strong>EC2-Tokyo</strong></p>
                                <small>📱 SSMエージェント待機中</small>
                            </div>
                            <div class="branch-item osaka">
                                <div style="font-size: 2.5em; margin-bottom: 10px;">🏢</div>
                                <h4>大阪支店</h4>
                                <p><strong>EC2-Osaka</strong></p>
                                <small>📱 SSMエージェント待機中</small>
                            </div>
                            <div class="branch-item nagoya">
                                <div style="font-size: 2.5em; margin-bottom: 10px;">🏢</div>
                                <h4>名古屋支店</h4>
                                <p><strong>EC2-Nagoya</strong></p>
                                <small>📱 SSMエージェント待機中</small>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; font-size: 2em; color: #48bb78;">⬇️</div>
                    <div style="text-align: center; font-weight: bold; color: #48bb78;">各支店で同時実行</div>
                    <div style="text-align: center; font-size: 2em; color: #48bb78;">⬇️</div>
                    
                    <div class="result-box">
                        <div style="text-align: center;">
                            <h3>📊 実行結果の報告</h3>
                            <p>✅ 東京支店: 作業完了 (成功)<br>
                            ✅ 大阪支店: 作業完了 (成功)<br>
                            ❌ 名古屋支店: エラー発生 (要確認)</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>📋 よく使用されるコマンド例</h2>
            <div class="command-examples">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">🛠️ 実際の業務で使われる指示例</h3>
                
                <div class="command-card">
                    <h4>🔄 システム再起動指示</h4>
                    <p><strong>会社の例:</strong> 「全支店のPCを明日朝に再起動して」</p>
                    <div class="command-code">
AWS-RunShellScript<br>
sudo reboot
                    </div>
                    <p><strong>結果:</strong> 指定したサーバーが安全に再起動されます</p>
                </div>

                <div class="command-card">
                    <h4>💾 ソフトウェアインストール</h4>
                    <p><strong>会社の例:</strong> 「新しいセキュリティソフトを全支店に導入して」</p>
                    <div class="command-code">
AWS-RunShellScript<br>
sudo yum update -y<br>
sudo yum install -y htop
                    </div>
                    <p><strong>結果:</strong> 全サーバーに同じソフトウェアがインストールされます</p>
                </div>

                <div class="command-card">
                    <h4>📊 システム状況確認</h4>
                    <p><strong>会社の例:</strong> 「各支店の業務状況を報告して」</p>
                    <div class="command-code">
AWS-RunShellScript<br>
df -h<br>
free -m<br>
ps aux | head -10
                    </div>
                    <p><strong>結果:</strong> 各サーバーのディスク使用量、メモリ使用量、稼働プロセスが分かります</p>
                </div>

                <div class="command-card">
                    <h4>🔧 設定ファイル配布</h4>
                    <p><strong>会社の例:</strong> 「新しい業務マニュアルを全支店に配布して」</p>
                    <div class="command-code">
AWS-RunShellScript<br>
aws s3 cp s3://my-bucket/config.txt /etc/myapp/<br>
sudo systemctl restart myapp
                    </div>
                    <p><strong>結果:</strong> 統一された設定ファイルが全サーバーに適用されます</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🎯 ターゲット指定機能</h2>
            <div class="intro-analogy">
                <h2>📍 特定の支店だけに指示を出したい場合</h2>
                <p>全支店ではなく、条件に合った特定の支店だけに指示を出すことも可能です</p>
            </div>

            <div class="analogy-cards">
                <div class="analogy-card">
                    <div class="analogy-icon">🏷️</div>
                    <h3>タグによる指定</h3>
                    <p><strong>会社の例:</strong><br>
                    「営業部」タグが付いた支店のみ<br>
                    「関東地方」タグが付いた支店のみ</p>
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>AWS例:</strong><br>
                        Environment=Production<br>
                        Department=Web-Server
                    </div>
                </div>

                <div class="analogy-card">
                    <div class="analogy-icon">📋</div>
                    <h3>インスタンスID指定</h3>
                    <p><strong>会社の例:</strong><br>
                    東京支店（支店番号：001）<br>
                    大阪支店（支店番号：002）<br>
                    のみに指示</p>
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>AWS例:</strong><br>
                        i-1234567890abcdef0<br>
                        i-0987654321fedcba0
                    </div>
                </div>

                <div class="analogy-card">
                    <div class="analogy-icon">🔍</div>
                    <h3>リソースグループ</h3>
                    <p><strong>会社の例:</strong><br>
                    「新規開店した支店」グループ<br>
                    「大型店舗」グループ<br>
                    事前に分類したグループ単位で指示</p>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>AWS例:</strong><br>
                        WebServers-Group<br>
                        DatabaseServers-Group
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>📋 実際の設定手順（超簡単版）</h2>
            <div class="step-by-step">
                <div class="step-item">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>事前準備：連絡担当者の配置</h3>
                        <p><strong>SSMエージェントの確認</strong><br>
                        → 各支店（EC2）に連絡担当者（SSMエージェント）が配置されているか確認<br>
                        → 最新のAmazon LinuxやWindows Serverには標準で含まれています<br>
                        → 古いOSの場合は手動インストールが必要</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>権限設定：指示する権限を与える</h3>
                        <p><strong>IAMロールの設定</strong><br>
                        → EC2に「AmazonSSMManagedInstanceCore」ポリシーを付与<br>
                        → 各支店が本社からの指示を受け取れるように権限設定<br>
                        → これがないと支店は指示を受け取れません</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Systems Managerコンソールを開く</h3>
                        <p><strong>管理画面へアクセス</strong><br>
                        → AWSコンソールでSystems Managerを選択<br>
                        → 左メニューから「Run Command」をクリック<br>
                        → 本社の管理者用の操作画面です</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>作業指示書を選択</h3>
                        <p><strong>Document（作業マニュアル）の選択</strong><br>
                        → AWS-RunShellScript（Linux用の基本的な作業）<br>
                        → AWS-RunPowerShellScript（Windows用）<br>
                        → または自作のカスタムドキュメント</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>対象支店を選択</h3>
                        <p><strong>ターゲットの指定</strong><br>
                        → すべての支店、または特定の支店を選択<br>
                        → タグやインスタンスIDで細かく指定可能<br>
                        → 「営業部の支店のみ」「関東地方のみ」など</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3>具体的な作業内容を入力</h3>
                        <p><strong>コマンドの入力</strong><br>
                        → 実行したいコマンドを入力欄に記載<br>
                        → 例：「sudo yum update -y」（システム更新）<br>
                        → 複数のコマンドを順番に実行することも可能</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <h3>実行ボタンをクリック！</h3>
                        <p><strong>一斉指示の送信</strong><br>
                        → 「Run」ボタンをクリックで指示を一斉送信<br>
                        → 各支店で同時に作業が開始されます<br>
                        → 実行状況はリアルタイムで確認可能</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">8</div>
                    <div class="step-content">
                        <h3>結果確認</h3>
                        <p><strong>各支店からの作業報告を確認</strong><br>
                        → 成功・失敗の状況を一覧で確認<br>
                        → 失敗した支店は詳細なエラーログも確認可能<br>
                        → 必要に応じて個別対応を実施</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>❓ よくある質問</h2>
            <div class="faq-section">
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🤔 なぜRun Commandが必要なの？
                    </div>
                    <div class="faq-answer">
                        <p><strong>効率性とスケーラビリティ</strong>のためです！</p>
                        <br>
                        <p><strong>従来の方法（SSH）:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>10台のサーバー → 10回のSSH接続が必要</li>
                            <li>各サーバーにログインして手動実行</li>
                            <li>1台ずつ作業するので時間がかかる</li>
                        </ul>
                        <br>
                        <p><strong>Run Command:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>100台のサーバー → 1回の操作で一斉実行</li>
                            <li>ブラウザから簡単操作</li>
                            <li>全サーバーで同時実行</li>
                        </ul>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        💰 料金はどのくらいかかるの？
                    </div>
                    <div class="faq-answer">
                        <p><strong>基本的には無料</strong>です！</p>
                        <br>
                        <p><strong>無料枠:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>月10万リクエストまで無料</li>
                            <li>Systems Manager自体の利用料は無料</li>
                            <li>EC2の実行時間のみ課金（通常通り）</li>
                        </ul>
                        <br>
                        <p><strong>有料になる場合:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>月10万リクエストを超えた場合</li>
                            <li>1リクエスト $0.00243（約0.3円）</li>
                        </ul>
                        <p style="margin-top: 15px;">一般的な企業なら、ほぼ無料で使えます！</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🔒 セキュリティは大丈夫？
                    </div>
                    <div class="faq-answer">
                        <p><strong>非常に安全</strong>です！</p>
                        <br>
                        <p><strong>セキュリティ機能:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>IAM権限:</strong> 実行可能な人を制限</li>
                            <li><strong>暗号化通信:</strong> 指示内容は暗号化して送信</li>
                            <li><strong>ログ記録:</strong> すべての実行履歴を記録</li>
                            <li><strong>CloudTrail連携:</strong> 誰がいつ実行したか監査可能</li>
                        </ul>
                        <br>
                        <p><strong>ベストプラクティス:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>最小権限の原則でIAM設定</li>
                            <li>重要な作業前には事前テスト</li>
                            <li>定期的な権限の見直し</li>
                        </ul>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🚨 実行に失敗した場合はどうする？
                    </div>
                    <div class="faq-answer">
                        <p><strong>詳細な診断情報</strong>が提供されます！</p>
                        <br>
                        <p><strong>失敗の確認方法:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>実行結果画面でステータス確認</li>
                            <li>失敗したインスタンスの詳細ログ表示</li>
                            <li>エラーメッセージから原因特定</li>
                        </ul>
                        <br>
                        <p><strong>よくある失敗原因:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>SSMエージェントが停止している</li>
                            <li>IAM権限が不足している</li>
                            <li>コマンド自体にエラーがある</li>
                            <li>対象インスタンスが停止している</li>
                        </ul>
                        <br>
                        <p><strong>対処法:</strong> 失敗したインスタンスのみを対象に再実行可能</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        ⏰ 実行タイミングを指定できる？
                    </div>
                    <div class="faq-answer">
                        <p><strong>はい！</strong>時間指定実行も可能です。</p>
                        <br>
                        <p><strong>方法1: EventBridge（CloudWatch Events）連携</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>毎日午前3時にシステム更新</li>
                            <li>毎週日曜日にバックアップ作業</li>
                            <li>cron形式でスケジュール設定</li>
                        </ul>
                        <br>
                        <p><strong>方法2: Maintenance Windows</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>メンテナンス時間帯を事前設定</li>
                            <li>その時間内でのみ作業実行</li>
                            <li>営業時間外の安全な作業実行</li>
                        </ul>
                        <br>
                        <p><strong>例:</strong> 「毎月第2土曜日の午前2時に全サーバーでパッチ適用」</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>✨ Run Commandの主なメリット</h2>
            <div class="benefit-grid">
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">⚡</div>
                    <h3>作業時間短縮</h3>
                    <p>100台のサーバーでも1回の操作で一斉実行。SSH接続の手間が不要</p>
                </div>
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">🎯</div>
                    <h3>作業品質向上</h3>
                    <p>手動作業のミスを防止。全サーバーで同じ作業が確実に実行される</p>
                </div>
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">👀</div>
                    <h3>可視性向上</h3>
                    <p>作業の実行状況と結果をリアルタイムで確認。履歴も残る</p>
                </div>
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">🔒</div>
                    <h3>セキュリティ強化</h3>
                    <p>SSHキーの管理不要。IAM権限で安全にアクセス制御</p>
                </div>
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">📊</div>
                    <h3>柔軟な対象指定</h3>
                    <p>タグやグループで細かく対象を指定。必要な支店のみに実行</p>
                </div>
                <div class="benefit-card">
                    <div style="font-size: 3em; margin-bottom: 15px;">💰</div>
                    <h3>コスト効率</h3>
                    <p>月10万リクエストまで無料。専用ツール導入より圧倒的に安い</p>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>🏢 実際のビジネス活用例：ECSクラスター管理</h2>
            <div class="intro-analogy">
                <h2>🏬 100階建てオフィスビルの安全管理システム</h2>
                <p>企業が新しいウェブサービスを立ち上げる際の、セキュリティを重視したサーバー管理の実例です</p>
            </div>

            <div class="simple-diagram">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">🏢 ECSクラスター = 100階建てオフィスビル</h3>
                
                <div class="command-flow">
                    <div class="flow-row">
                        <div class="center-item" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <div style="font-size: 3em; margin-bottom: 15px;">🏢</div>
                            <h3>新ウェブサービス用ビル</h3>
                            <p><strong>Amazon ECS クラスター</strong></p>
                            <small>100台のEC2インスタンス = 100階のオフィス</small>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
                        <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
                            <h4 style="color: #e53e3e; margin-bottom: 15px;">❌ 従来の方法（禁止）</h4>
                            <div style="background: #fed7d7; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <strong>🔑 SSH接続 = 各階に個別の合鍵配布</strong>
                                <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.9em;">
                                    <li>鍵の管理が大変</li>
                                    <li>紛失・悪用リスク</li>
                                    <li>セキュリティホール</li>
                                </ul>
                            </div>
                            <div style="background: #fed7d7; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <strong>🚪 複数ポート開放 = 裏口・非常口も開放</strong>
                                <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.9em;">
                                    <li>攻撃経路が多い</li>
                                    <li>管理が複雑</li>
                                    <li>侵入リスク高</li>
                                </ul>
                            </div>
                        </div>

                        <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
                            <h4 style="color: #38a169; margin-bottom: 15px;">✅ 新方式（採用）</h4>
                            <div style="background: #c6f6d5; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <strong>🚪 HTTPS（443）のみ開放 = 正面玄関のみ</strong>
                                <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.9em;">
                                    <li>お客様アクセス専用</li>
                                    <li>最小限のリスク</li>
                                    <li>明確な用途</li>
                                </ul>
                            </div>
                            <div style="background: #c6f6d5; padding: 15px; border-radius: 8px; margin: 10px 0;">
                                <strong>📱 Run Command = 中央制御システム</strong>
                                <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.9em;">
                                    <li>鍵なしでリモート管理</li>
                                    <li>一括操作可能</li>
                                    <li>完全な監査証跡</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="step-by-step">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">🛡️ セキュリティポリシーの実装手順</h3>
                
                <div class="step-item" style="border-left-color: #f093fb;">
                    <div class="step-number" style="background: #f093fb;">1</div>
                    <div class="step-content">
                        <h3>ECSクラスターの構築</h3>
                        <p><strong>100階建てオフィスビルの建設</strong><br>
                        → 100台のEC2インスタンスでECSクラスターを構築<br>
                        → 各インスタンスに「SSMエージェント」を配置（連絡担当者）<br>
                        → 新しいウェブサービス専用の環境を準備</p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #e53e3e;">
                    <div class="step-number" style="background: #e53e3e;">2</div>
                    <div class="step-content">
                        <h3>厳格なセキュリティグループ設定</h3>
                        <p><strong>ビルの入口を最小限に制限</strong><br>
                        → <strong>インバウンド：</strong>HTTPS（443）のみ許可<br>
                        → <strong>ブロック：</strong>SSH（22）、HTTP（80）、その他全て<br>
                        → 会社のセキュリティポリシーに完全準拠</p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #38a169;">
                    <div class="step-number" style="background: #38a169;">3</div>
                    <div class="step-content">
                        <h3>SSHキーなしでインスタンス起動</h3>
                        <p><strong>物理的な鍵を一切使わない方針</strong><br>
                        → EC2起動時にSSHキーペアを指定しない<br>
                        → 従来の「鍵管理」リスクを完全排除<br>
                        → 紛失・悪用・不正アクセスの心配なし</p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #4299e1;">
                    <div class="step-number" style="background: #4299e1;">4</div>
                    <div class="step-content">
                        <h3>Run Commandによる中央管理</h3>
                        <p><strong>統合管理システムの稼働開始</strong><br>
                        → 管理者は中央制御室（AWSコンソール）から操作<br>
                        → 100台すべてに同時指示が可能<br>
                        → セキュアで効率的なリモート管理を実現</p>
                    </div>
                </div>
            </div>

            <div class="command-examples">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">🛠️ ECSクラスターでの実際の管理作業例</h3>
                
                <div class="command-card">
                    <h4>🔄 コンテナ関連の一斉操作</h4>
                    <p><strong>ビル全体でのシステム更新作業</strong></p>
                    <div class="command-code">
# Docker設定の更新
sudo systemctl restart docker<br>
# ECSエージェントの再起動
sudo systemctl restart ecs
                    </div>
                    <p><strong>効果:</strong> 100台のサーバーで同時にコンテナ環境を更新</p>
                </div>

                <div class="command-card">
                    <h4>📊 クラスター状況の一斉確認</h4>
                    <p><strong>全階の業務状況を一斉チェック</strong></p>
                    <div class="command-code">
# クラスター状況確認
docker ps<br>
# リソース使用量確認
df -h && free -m<br>
# ECSタスク状況確認
curl -s http://localhost:51678/v1/tasks
                    </div>
                    <p><strong>効果:</strong> 全サーバーの稼働状況を瞬時に把握</p>
                </div>

                <div class="command-card">
                    <h4>🔧 セキュリティパッチの一斉適用</h4>
                    <p><strong>ビル全体のセキュリティ強化作業</strong></p>
                    <div class="command-code">
# システム更新
sudo yum update -y<br>
# セキュリティパッチ適用
sudo yum update --security<br>
# ログ確認
tail -f /var/log/ecs/ecs-agent.log
                    </div>
                    <p><strong>効果:</strong> 全サーバーを同じセキュリティレベルに統一</p>
                </div>
            </div>

            <div class="faq-section">
                <h3 style="text-align: center; margin-bottom: 20px; color: #d63384;">💡 このアプローチの優れた点</h3>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🛡️ なぜSSHを使わないのか？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>セキュリティリスクの排除</strong>のためです。</p>
                        <br>
                        <p><strong>SSHの問題点:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>鍵管理の複雑さ:</strong> 100台分の鍵ペア管理</li>
                            <li><strong>紛失リスク:</strong> 秘密鍵の漏洩可能性</li>
                            <li><strong>攻撃対象:</strong> SSH（ポート22）への総当たり攻撃</li>
                            <li><strong>監査の困難:</strong> 誰がいつアクセスしたか追跡困難</li>
                        </ul>
                        <br>
                        <p><strong>Run Commandの優位性:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>鍵不要:</strong> IAM権限のみで制御</li>
                            <li><strong>完全監査:</strong> すべての操作がCloudTrailに記録</li>
                            <li><strong>攻撃面縮小:</strong> SSHポートを完全閉鎖</li>
                        </ul>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🔒 HTTPSのみでなぜ十分なのか？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>用途が明確</strong>だからです。</p>
                        <br>
                        <p><strong>HTTPS（ポート443）の役割:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Webサービス提供:</strong> ユーザーからのHTTPSアクセス</li>
                            <li><strong>ロードバランサー通信:</strong> ALB/NLBからの転送</li>
                            <li><strong>ヘルスチェック:</strong> ECSサービスの稼働確認</li>
                        </ul>
                        <br>
                        <p><strong>管理作業は別ルート:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Run Command:</strong> AWS内部ネットワーク経由</li>
                            <li><strong>インターネット不経由:</strong> 外部からの攻撃不可</li>
                            <li><strong>IAM制御:</strong> 権限がある人のみ実行可能</li>
                        </ul>
                        <br>
                        <p>💡 <strong>結果:</strong> 最小権限の原則を完璧に実現</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        ⚡ 100台を一斉管理する実際のメリットは？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>運用効率が劇的に改善</strong>します。</p>
                        <br>
                        <p><strong>時間短縮効果:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>従来（SSH）:</strong> 100台 × 5分 = 500分（8.3時間）</li>
                            <li><strong>Run Command:</strong> 1回の操作 = 5分</li>
                            <li><strong>短縮効果:</strong> 99%の時間削減！</li>
                        </ul>
                        <br>
                        <p><strong>品質向上効果:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>作業統一:</strong> 全サーバーで同一の操作</li>
                            <li><strong>ミス防止:</strong> 手動入力ミスの排除</li>
                            <li><strong>同期実行:</strong> タイミングのズレなし</li>
                        </ul>
                        <br>
                        <p><strong>コスト削減効果:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>人件費削減:</strong> 作業時間99%短縮</li>
                            <li><strong>障害対応:</strong> 迅速な一斉復旧</li>
                            <li><strong>予防保守:</strong> 定期的な一斉メンテナンス</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="benefit-grid">
                <div class="benefit-card" style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">🛡️</div>
                    <h3>セキュリティ最大化</h3>
                    <p>攻撃経路を最小限に制限。SSH鍵管理リスクを完全排除</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #81ecec 0%, #74b9ff 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">⚡</div>
                    <h3>運用効率最大化</h3>
                    <p>100台のサーバーを1回の操作で管理。作業時間99%削減</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">📊</div>
                    <h3>品質統一</h3>
                    <p>全サーバーで同一の設定・操作。環境差異によるトラブル防止</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">💰</div>
                    <h3>コスト最適化</h3>
                    <p>管理工数大幅削減。障害対応時間短縮。予防保守効率化</p>
                </div>
            </div>

            <div class="highlight-box" style="background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);">
                <h3>🎯 ECSクラスター管理のベストプラクティス</h3>
                <div style="text-align: left; margin-top: 20px;">
                    <p><strong>✅ セキュリティ面:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>最小権限の原則：必要なポートのみ開放</li>
                        <li>SSH鍵なし運用：物理的鍵管理リスクを排除</li>
                        <li>Run Command活用：セキュアな管理チャネル確保</li>
                    </ul>
                    <br>
                    <p><strong>⚡ 運用面:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>一括操作：スケールに関係なく同じ工数</li>
                        <li>作業標準化：ドキュメント化された手順</li>
                        <li>監査証跡：全操作の完全な記録</li>
                    </ul>
                    <br>
                    <p><strong>🔄 継続改善:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>定期的なセキュリティ見直し</li>
                        <li>自動化の推進（EventBridge連携）</li>
                        <li>運用メトリクスの継続監視</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>📞 なぜインバウンドポートを開く必要がないの？</h2>
            <div class="intro-analogy">
                <h2>🔄 アウトバウンド通信の魔法</h2>
                <p>Run Commandは「外から中」ではなく、「中から外」への通信だけで完璧に動作します</p>
            </div>

            <div class="comparison-table">
                <div class="comparison-side" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                    <h3>❌ 従来のSSH接続</h3>
                    <div style="font-size: 1.1em; margin-top: 15px;">
                        <div style="font-size: 3em; margin: 10px 0;">📞</div>
                        <p><strong>固定電話への着信</strong></p>
                        <br>
                        <p>🏢 ← 👨‍💼<br>
                        サーバーが「電話を受ける」</p>
                        <br>
                        <div style="background: rgba(255,255,255,0.3); padding: 10px; border-radius: 8px;">
                            <strong>問題:</strong><br>
                            ✗ インバウンドポート22必要<br>
                            ✗ 外部から直接アクセス可能<br>
                            ✗ 攻撃者の標的になりやすい
                        </div>
                    </div>
                </div>
                <div class="comparison-side aws-side">
                    <h3>✅ Run Command</h3>
                    <div style="font-size: 1.1em; margin-top: 15px;">
                        <div style="font-size: 3em; margin: 10px 0;">📱</div>
                        <p><strong>携帯電話からの発信</strong></p>
                        <br>
                        <p>🏢 → ☁️<br>
                        サーバーが「電話をかける」</p>
                        <br>
                        <div style="background: rgba(255,255,255,0.3); padding: 10px; border-radius: 8px;">
                            <strong>利点:</strong><br>
                            ✓ アウトバウンドHTTPS(443)のみ<br>
                            ✓ 外部からアクセス不可<br>
                            ✓ デフォルト設定で動作
                        </div>
                    </div>
                </div>
            </div>

            <div class="simple-diagram">
                <h3 style="text-align: center; margin-bottom: 30px; color: #667eea;">🔄 通信方向の違いを理解しよう</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 30px 0;">
                    <!-- インバウンド通信 -->
                    <div style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); padding: 25px; border-radius: 15px;">
                        <h4 style="text-align: center; margin-bottom: 20px; color: #c53030;">❌ インバウンド通信（SSH）</h4>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
                            <div style="background: white; padding: 15px; border-radius: 10px; width: 80%; text-align: center;">
                                <strong>👨‍💼 管理者</strong><br>
                                <small>IPアドレス: どこか不明</small>
                            </div>
                            <div style="font-size: 2em; color: #c53030;">⬇️</div>
                            <div style="background: rgba(255,255,255,0.8); padding: 10px; border-radius: 8px; font-family: monospace; font-size: 0.9em;">
                                🌐 インターネット経由<br>
                                ポート22 (SSH)
                            </div>
                            <div style="font-size: 2em; color: #c53030;">⬇️</div>
                            <div style="background: white; padding: 15px; border-radius: 10px; width: 80%; text-align: center;">
                                <strong>🏢 EC2サーバー</strong><br>
                                <small>ポート22を開放必須</small>
                            </div>
                        </div>
                        <div style="background: rgba(197,48,48,0.2); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <strong>リスク:</strong> 外部から侵入可能な「入口」を作る
                        </div>
                    </div>

                    <!-- アウトバウンド通信 -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; color: white;">
                        <h4 style="text-align: center; margin-bottom: 20px;">✅ アウトバウンド通信（Run Command）</h4>
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 15px;">
                            <div style="background: rgba(255,255,255,0.9); color: #333; padding: 15px; border-radius: 10px; width: 80%; text-align: center;">
                                <strong>🏢 EC2サーバー</strong><br>
                                <small>SSMエージェント起動中</small>
                            </div>
                            <div style="font-size: 2em;">⬆️</div>
                            <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; font-family: monospace; font-size: 0.9em;">
                                📱 「仕事ありますか？」<br>
                                HTTPS(443)でポーリング
                            </div>
                            <div style="font-size: 2em;">⬆️</div>
                            <div style="background: rgba(255,255,255,0.9); color: #333; padding: 15px; border-radius: 10px; width: 80%; text-align: center;">
                                <strong>☁️ AWS Systems Manager</strong><br>
                                <small>指示待ち・結果受け取り</small>
                            </div>
                        </div>
                        <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <strong>安全:</strong> 外部からアクセス不可能な「出口」のみ
                        </div>
                    </div>
                </div>
            </div>

            <div class="step-by-step">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">📱 Run Commandの詳細な動作シーケンス</h3>
                
                <div class="step-item" style="border-left-color: #4299e1;">
                    <div class="step-number" style="background: #4299e1;">1</div>
                    <div class="step-content">
                        <h3>SSMエージェントの起動</h3>
                        <p><strong>連絡担当者が待機開始</strong><br>
                        → EC2起動時にSSMエージェントが自動起動<br>
                        → 「仕事がないか」定期的にAWSに確認する準備完了<br>
                        → <strong>インバウンドポートは一切不要</strong></p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #48bb78;">
                    <div class="step-number" style="background: #48bb78;">2</div>
                    <div class="step-content">
                        <h3>定期的なポーリング通信</h3>
                        <p><strong>「何かお仕事ありますか？」の定期確認</strong><br>
                        → アウトバウンドHTTPS(443)でAWS Systems Managerに問い合わせ<br>
                        → 通常は「特に仕事なし」の応答<br>
                        → <strong>デフォルトのセキュリティグループ設定で動作</strong></p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #ed8936;">
                    <div class="step-number" style="background: #ed8936;">3</div>
                    <div class="step-content">
                        <h3>管理者による指示送信</h3>
                        <p><strong>本社からの作業指示</strong><br>
                        → 管理者がAWSコンソールでRun Command実行<br>
                        → AWS Systems Managerが指示を保管<br>
                        → <strong>管理者とEC2は直接通信しない</strong></p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #9f7aea;">
                    <div class="step-number" style="background: #9f7aea;">4</div>
                    <div class="step-content">
                        <h3>指示の受け取りと実行</h3>
                        <p><strong>次回のポーリングで指示を発見</strong><br>
                        → SSMエージェントが「今度は仕事がある！」を確認<br>
                        → 指示内容をダウンロードして実行開始<br>
                        → <strong>全てアウトバウンド通信で完結</strong></p>
                    </div>
                </div>

                <div class="step-item" style="border-left-color: #38a169;">
                    <div class="step-number" style="background: #38a169;">5</div>
                    <div class="step-content">
                        <h3>結果の報告</h3>
                        <p><strong>作業完了報告</strong><br>
                        → 実行結果をアウトバウンドHTTPS(443)でAWSに送信<br>
                        → AWS Systems Managerが結果を保存<br>
                        → 管理者はコンソールで結果確認可能</p>
                    </div>
                </div>
            </div>

            <div class="command-examples">
                <h3 style="text-align: center; margin-bottom: 20px; color: #667eea;">🔧 実際のセキュリティグループ設定例</h3>
                
                <div class="command-card">
                    <h4>🛡️ 推奨セキュリティグループ設定</h4>
                    <p><strong>最小権限の原則を適用</strong></p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0;">
                        <div style="background: #e6fffa; padding: 15px; border-radius: 8px; border-left: 4px solid #38a169;">
                            <h5 style="color: #38a169;">✅ インバウンドルール</h5>
                            <div class="command-code" style="background: #2d3748; color: #e2e8f0; margin-top: 10px;">
Type: HTTPS<br>
Port: 443<br>
Source: 0.0.0.0/0<br>
Purpose: お客様のWebアクセス用
                            </div>
                        </div>
                        <div style="background: #e6fffa; padding: 15px; border-radius: 8px; border-left: 4px solid #38a169;">
                            <h5 style="color: #38a169;">✅ アウトバウンドルール</h5>
                            <div class="command-code" style="background: #2d3748; color: #e2e8f0; margin-top: 10px;">
Type: All Traffic<br>
Port: All<br>
Destination: 0.0.0.0/0<br>
Purpose: AWS通信＋ソフトウェア更新
                            </div>
                        </div>
                    </div>
                    <div style="background: #fed7d7; padding: 15px; border-radius: 8px; border-left: 4px solid #e53e3e; margin-top: 15px;">
                        <h5 style="color: #e53e3e;">❌ 不要なルール（追加しない）</h5>
                        <div style="font-family: monospace; margin-top: 10px;">
                            <strike>Type: SSH, Port: 22</strike> → Run Commandがあるので不要<br>
                            <strike>Type: RDP, Port: 3389</strike> → Windows でも不要<br>
                            <strike>Type: Custom TCP</strike> → 管理用ポートは全て不要
                        </div>
                    </div>
                </div>

                <div class="command-card">
                    <h4>🔍 ネットワーク要件の確認</h4>
                    <p><strong>Run Command が動作するための最小要件</strong></p>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <h5>必要な通信先（アウトバウンドのみ）:</h5>
                        <div class="command-code" style="margin-top: 10px;">
# Systems Manager エンドポイント<br>
ssm.region.amazonaws.com:443<br>
<br>
# メッセージングサービス<br>  
ssmmessages.region.amazonaws.com:443<br>
<br>
# EC2メッセージング<br>
ec2messages.region.amazonaws.com:443
                        </div>
                    </div>
                    <div style="background: #edf2f7; padding: 15px; border-radius: 8px;">
                        <strong>💡 ネットワーク構成オプション:</strong>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>パブリックサブネット:</strong> Internet Gateway 経由</li>
                            <li><strong>プライベートサブネット:</strong> NAT Gateway 経由</li>
                            <li><strong>完全プライベート:</strong> VPC Endpoint 経由</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>どの構成でもインバウンドポート開放は不要！</strong></p>
                    </div>
                </div>
            </div>

            <div class="faq-section">
                <h3 style="text-align: center; margin-bottom: 20px; color: #d63384;">🤔 アウトバウンド通信に関するよくある質問</h3>
                
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        📞 アウトバウンドだけで本当にリアルタイム管理できるの？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>はい、実用上問題ありません！</strong></p>
                        <br>
                        <p><strong>ポーリング方式の仕組み:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>通常時:</strong> 数秒〜数十秒間隔で確認</li>
                            <li><strong>指示発行時:</strong> 即座に全インスタンスが確認</li>
                            <li><strong>緊急時:</strong> より頻繁な確認に自動調整</li>
                        </ul>
                        <br>
                        <p><strong>比較例:</strong></p>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            📧 <strong>メール受信:</strong> メールソフトが定期的にサーバーを確認<br>
                            📞 <strong>電話着信:</strong> 常に待ち受け状態（インバウンド）<br>
                            📱 <strong>Run Command:</strong> メール方式と同じ（安全）
                        </div>
                        <p><strong>結果:</strong> ほぼリアルタイムでの実行が可能です</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🔒 デフォルトのアウトバウンド設定で本当に安全？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>非常に安全です！</strong>理由は通信方向にあります。</p>
                        <br>
                        <p><strong>アウトバウンド通信の特徴:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>接続開始:</strong> 必ず内部から外部へ</li>
                            <li><strong>セッション管理:</strong> 既存セッションのみ応答可能</li>
                            <li><strong>外部からの接続:</strong> 物理的に不可能</li>
                        </ul>
                        <br>
                        <p><strong>セキュリティの仕組み:</strong></p>
                        <div style="background: #f0fff4; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <strong>🛡️ ステートフル ファイアウォール:</strong><br>
                            ・EC2 → AWS への通信：許可<br>
                            ・AWS → EC2 への応答：許可（既存セッション）<br>
                            ・外部 → EC2 への新規接続：拒否
                        </div>
                        <br>
                        <p><strong>追加セキュリティ層:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>HTTPS暗号化:</strong> 通信内容の保護</li>
                            <li><strong>IAM認証:</strong> 正当なサービスのみ通信</li>
                            <li><strong>署名検証:</strong> 改ざん検知機能</li>
                        </ul>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        🌐 インターネット接続がない環境では使えない？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>VPC Endpoint を使えば完全プライベート環境でも利用可能！</strong></p>
                        <br>
                        <p><strong>接続方法の選択肢:</strong></p>
                        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin: 15px 0;">
                            <div style="background: #e6fffa; padding: 15px; border-radius: 8px;">
                                <strong>🌐 方法1: インターネット経由</strong><br>
                                Internet Gateway → AWS Services<br>
                                <small>最も簡単、追加費用なし</small>
                            </div>
                            <div style="background: #e6fffa; padding: 15px; border-radius: 8px;">
                                <strong>🔧 方法2: NAT Gateway経由</strong><br>
                                Private Subnet → NAT Gateway → AWS Services<br>
                                <small>プライベート環境、NAT Gateway料金</small>
                            </div>
                            <div style="background: #e6fffa; padding: 15px; border-radius: 8px;">
                                <strong>🏢 方法3: VPC Endpoint経由</strong><br>
                                Private Subnet → VPC Endpoint → AWS Services<br>
                                <small>完全プライベート、エンドポイント料金</small>
                            </div>
                        </div>
                        <br>
                        <p><strong>必要なVPC Endpoints:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>com.amazonaws.region.ssm</li>
                            <li>com.amazonaws.region.ssmmessages</li>
                            <li>com.amazonaws.region.ec2messages</li>
                        </ul>
                        <br>
                        <p><strong>💡 どの方法も「アウトバウンド通信のみ」という原則は同じです</strong></p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        ⚡ SSH と比べて性能は劣らない？
                    </div>
                    <div class="faq-answer" style="display: none;">
                        <p><strong>多くの場面でSSHより優れています！</strong></p>
                        <br>
                        <p><strong>性能比較:</strong></p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                            <div style="background: #fed7d7; padding: 15px; border-radius: 8px;">
                                <strong>SSH接続</strong><br>
                                ・接続時間: 1-3秒/台<br>
                                ・並列実行: 手動管理<br>
                                ・エラー処理: 個別対応<br>
                                ・ログ管理: 分散保存
                            </div>
                            <div style="background: #c6f6d5; padding: 15px; border-radius: 8px;">
                                <strong>Run Command</strong><br>
                                ・実行時間: 即座（全台同時）<br>
                                ・並列実行: 自動管理<br>
                                ・エラー処理: 一括確認<br>
                                ・ログ管理: 中央集約
                            </div>
                        </div>
                        <br>
                        <p><strong>特に優れている点:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>同時実行:</strong> 100台でも1台でも同じ時間</li>
                            <li><strong>ネットワーク効率:</strong> AWSのインフラを活用</li>
                            <li><strong>再試行機能:</strong> 失敗時の自動リトライ</li>
                            <li><strong>タイムアウト管理:</strong> 無応答サーバーの自動処理</li>
                        </ul>
                        <br>
                        <p><strong>実測例:</strong></p>
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px;">
                            100台のサーバーでソフトウェア更新:<br>
                            🐌 <strong>SSH:</strong> 100台 × 2分 = 200分<br>
                            🚀 <strong>Run Command:</strong> 1回の操作 = 2分
                        </div>
                    </div>
                </div>
            </div>

            <div class="benefit-grid">
                <div class="benefit-card" style="background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">🔒</div>
                    <h3>ゼロインバウンド</h3>
                    <p>外部からアクセス可能なポートを開く必要なし。攻撃面を最小化</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">🎯</div>
                    <h3>デフォルト動作</h3>
                    <p>複雑なファイアウォール設定不要。標準設定で即座に利用開始</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">📡</div>
                    <h3>ポーリング方式</h3>
                    <p>サーバー側から定期確認。リアルタイム性と安全性を両立</p>
                </div>
                <div class="benefit-card" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                    <div style="font-size: 3em; margin-bottom: 15px;">🌐</div>
                    <h3>柔軟なネットワーク</h3>
                    <p>インターネット、NAT、VPCエンドポイント。どの構成でも対応</p>
                </div>
            </div>

            <div class="highlight-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h3>🎯 アウトバウンド通信方式の核心価値</h3>
                <div style="text-align: left; margin-top: 20px;">
                    <p><strong>🔑 セキュリティ革命:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>従来の「外→内」から「内→外」への発想転換</li>
                        <li>管理用ポートの完全廃止</li>
                        <li>攻撃面の劇的な縮小</li>
                    </ul>
                    <br>
                    <p><strong>⚡ 運用効率:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>複雑なネットワーク設定が不要</li>
                        <li>即座に利用開始可能</li>
                        <li>スケールに関係ない一定の性能</li>
                    </ul>
                    <br>
                    <p><strong>🎛️ 技術的優位性:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>ステートフル通信の活用</li>
                        <li>AWS インフラとの最適な統合</li>
                        <li>クラウドネイティブな設計思想</li>
                    </ul>
                    <br>
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>💡 結論:</strong> Run Command は「セキュリティ」「効率性」「簡単さ」の三拍子が揃った、<br>
                        現代のクラウド管理における理想的なソリューションです
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="highlight-box">
                <h2>🎯 まとめ</h2>
                <div style="text-align: left; margin-top: 20px; font-size: 1.1em;">
                    <p>👨‍💼 <strong>Run Command</strong> = 本社の管理者（一斉指示を出す人）</p>
                    <p>🏢 <strong>EC2インスタンス</strong> = 各支店（指示を受けて作業する場所）</p>
                    <p>📱 <strong>SSMエージェント</strong> = 連絡担当者（指示を受け取って実行する人）</p>
                    <p>📋 <strong>Document</strong> = 作業マニュアル（具体的な手順書）</p>
                    <br>
                    <p>この仕組みを使うことで、<strong>複数のサーバーを効率的に一元管理</strong>できます！</p>
                    <br>
                    <p><strong>🎯 初心者へのアドバイス：</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>小さな作業から始めてみる（システム情報確認など）</li>
                        <li>重要な作業の前は必ず1台でテスト実行</li>
                        <li>IAM権限の設定は慎重に（最小権限の原則）</li>
                        <li>作業の実行履歴は定期的に確認</li>
                    </ul>
                    <br>
                    <p><strong>💡 実際の活用例：</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>セキュリティパッチの一斉適用</li>
                        <li>アプリケーションの設定変更</li>
                        <li>システム監視データの収集</li>
                        <li>緊急時の一斉作業実行</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleFaq(element) {
            const answer = element.nextElementSibling;
            const isVisible = answer.style.display !== 'none';
            
            answer.style.display = isVisible ? 'none' : 'block';
            element.style.background = isVisible ? '#667eea' : '#5a6fd8';
        }

        // アニメーション効果
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.analogy-card, .branch-item, .benefit-card');
            
            cards.forEach(card => {
                card.addEventListener('click', function() {
                    this.style.transform = 'scale(1.1) rotate(1deg)';
                    setTimeout(() => {
                        this.style.transform = 'translateY(-5px)';
                    }, 200);
                });
            });

            // スクロール時のアニメーション
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });
            
            document.querySelectorAll('.section').forEach(section => {
                observer.observe(section);
            });

            // コマンド実行のシミュレーション
            const commandCards = document.querySelectorAll('.command-card');
            function animateCommandExecution() {
                commandCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.style.borderLeftColor = '#4facfe';
                        card.style.transform = 'translateX(10px) scale(1.02)';
                        
                        setTimeout(() => {
                            card.style.borderLeftColor = '#48bb78';
                            card.style.transform = 'translateX(0) scale(1)';
                        }, 1000);
                    }, index * 300);
                });
            }
            
            // 15秒ごとにコマンド実行アニメーションを実行
            setInterval(animateCommandExecution, 15000);

            // 支店アニメーション
            const branchItems = document.querySelectorAll('.branch-item');
            function animateBranches() {
                branchItems.forEach((item, index) => {
                    setTimeout(() => {
                        item.style.transform = 'scale(1.1)';
                        item.style.borderColor = '#4facfe';
                        
                        setTimeout(() => {
                            item.style.transform = 'scale(1)';
                            item.style.borderColor = 'transparent';
                        }, 800);
                    }, index * 500);
                });
            }
            
            // 12秒ごとに支店アニメーションを実行
            setInterval(animateBranches, 12000);
        });
    </script>
    <button style="position: fixed; bottom: 30px; right: 30px; background-color: #FF9900; color: white; border: none; padding: 15px 30px; border-radius: 50px; font-size: 1.1em; font-weight: bold; cursor: pointer; box-shadow: 0 4px 12px rgba(255, 153, 0, 0.3); transition: all 0.3s ease; z-index: 1000;" onclick="window.location.href='../index.html'" onmouseover="this.style.backgroundColor='#E68900'; this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 16px rgba(255, 153, 0, 0.4)';" onmouseout="this.style.backgroundColor='#FF9900'; this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(255, 153, 0, 0.3)';">🏠 ホームに戻る</button>


    <div style="text-align: center; padding: 20px; margin-top: 40px; border-top: 2px solid #E5E7EB; background-color: #F9FAFB;">
        <p style="color: #6B7280; font-size: 0.9em; margin: 0;">
            Created by <a href="https://github.com/suzuki100603" target="_blank" style="color: #FF9900; text-decoration: none; font-weight: 600;">suzuki100603</a>
        </p>
        <p style="color: #9CA3AF; font-size: 0.8em; margin: 5px 0 0 0;">
            AWS SAP Learning Resources
        </p>
    </div>

</body>
</html>