<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS ACMでSANを利用した複数ドメインSSL証明書取得ガイド</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #232F3E;
            text-align: center;
            border-bottom: 2px solid #FF9900;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #232F3E;
            border-left: 4px solid #FF9900;
            padding-left: 10px;
            margin-top: 30px;
        }
        
        .intro {
            background-color: #EEF4FF;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }
        
        .step-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .step {
            flex: 1 1 300px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            position: relative;
            border: 1px solid #e0e0e0;
        }
        
        .step-number {
            position: absolute;
            top: -15px;
            left: -15px;
            background-color: #FF9900;
            color: white;
            width: 30px;
            height: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            font-weight: bold;
        }
        
        .step h3 {
            color: #232F3E;
            margin-top: 5px;
        }
        
        .diagram {
            background-color: #f9f9f9;
            border-radius: 6px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
        }
        
        .aws-service {
            display: inline-block;
            background-color: #232F3E;
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin: 10px;
            width: 120px;
            text-align: center;
        }
        
        .aws-arrow {
            display: inline-block;
            color: #FF9900;
            font-size: 24px;
            margin: 0 10px;
            vertical-align: middle;
        }
        
        .aws-certificate {
            display: inline-block;
            background-color: #FF9900;
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin: 10px;
            width: 200px;
            text-align: center;
        }
        
        .domain-list {
            background-color: #f0f0f0;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .domain {
            display: inline-block;
            background-color: #E9F5E9;
            border: 1px solid #c0c0c0;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 4px;
            color: #333;
            font-weight: bold;
        }
        
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .benefit-card {
            background-color: #EEF4FF;
            border-radius: 6px;
            padding: 15px;
            border-top: 3px solid #FF9900;
        }
        
        .benefit-card h4 {
            color: #232F3E;
            margin-top: 0;
        }
        
        .note {
            background-color: #FFF9E6;
            border-left: 4px solid #FF9900;
            padding: 15px;
            margin: 20px 0;
        }
        
        .troubleshooting {
            background-color: #FFF0F0;
            border-radius: 6px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .conclusion {
            background-color: #E9F5E9;
            border-radius: 6px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .flow-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
        }
        
        .flow-step {
            background-color: #232F3E;
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin: 10px;
            width: 80%;
            max-width: 400px;
            text-align: center;
            position: relative;
        }
        
        .flow-arrow {
            height: 30px;
            color: #FF9900;
            font-size: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AWS ACMでSANを利用した複数ドメインSSL証明書取得ガイド</h1>
        
        <div class="intro">
            <h2>はじめに：ACMとSANとは？</h2>
            <p><strong>AWS Certificate Manager (ACM)</strong>は、AWSが提供するSSL/TLS証明書の管理サービスです。アプリケーションやウェブサイトのセキュリティを確保するために必要な証明書を簡単に作成、管理できます。</p>
            <p><strong>SAN (Subject Alternative Name)</strong>は、1つのSSL証明書で複数のドメイン名を保護できる機能です。これにより、ドメインごとに個別の証明書を管理する手間を省くことができます。</p>
        </div>
        
        <div class="diagram">
            <h3>SANを利用した証明書の構造</h3>
            <div class="aws-certificate">
                SSL証明書
                <div class="domain-list">
                    <div class="domain">primary.example.com</div>
                    <div class="domain">www.example.com</div>
                    <div class="domain">api.example.com</div>
                    <div class="domain">app.example.com</div>
                </div>
            </div>
        </div>
        
        <h2>ACMでSANを利用した証明書取得の手順</h2>
        
        <div class="flow-diagram">
            <div class="flow-step">AWS Management Consoleにログイン</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">ACMサービスに移動</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">「証明書のリクエスト」をクリック</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">複数のドメイン名を入力</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">検証方法を選択</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">検証を完了</div>
            <div class="flow-arrow">↓</div>
            <div class="flow-step">証明書の発行と使用</div>
        </div>
        
        <div class="step-container">
            <div class="step">
                <div class="step-number">1</div>
                <h3>AWSコンソールにアクセス</h3>
                <p>AWS Management Consoleにログインします。右上の検索バーで「Certificate Manager」または「ACM」と検索してACMサービスに移動します。</p>
            </div>
            
            <div class="step">
                <div class="step-number">2</div>
                <h3>証明書のリクエスト</h3>
                <p>ACMダッシュボードで「証明書のリクエスト」ボタンをクリックします。「パブリック証明書のリクエスト」を選択し、「次へ」をクリックします。</p>
            </div>
            
            <div class="step">
                <div class="step-number">3</div>
                <h3>ドメイン名の入力</h3>
                <p>「ドメイン名」欄にメインドメイン（例：example.com）を入力します。次に「別の名前を追加」をクリックして、保護したい追加ドメインやサブドメインを入力します。</p>
                <div class="domain-list">
                    <p><strong>例：</strong></p>
                    <div class="domain">example.com</div>
                    <div class="domain">www.example.com</div>
                    <div class="domain">api.example.com</div>
                    <div class="domain">shop.example.com</div>
                </div>
            </div>
        </div>
        
        <div class="step-container">
            <div class="step">
                <div class="step-number">4</div>
                <h3>検証方法の選択</h3>
                <p>「DNS検証」または「Eメール検証」のいずれかを選択します。初心者には「DNS検証」がおすすめです（より信頼性が高く、自動更新も可能）。</p>
            </div>
            
            <div class="step">
                <div class="step-number">5</div>
                <h3>タグの追加（オプション）</h3>
                <p>必要に応じて、証明書を整理するためのタグを追加します。「次へ」をクリックして確認ページに進みます。</p>
            </div>
            
            <div class="step">
                <div class="step-number">6</div>
                <h3>確認と送信</h3>
                <p>入力内容を確認し、「確認とリクエスト」ボタンをクリックします。</p>
            </div>
        </div>
        
        <h2>検証の完了</h2>
        
        <div class="step-container">
            <div class="step">
                <div class="step-number">7</div>
                <h3>DNS検証の場合</h3>
                <p>ACMが提供するCNAMEレコードをドメインのDNS設定に追加します。Route 53を使用している場合は「DNSレコードをRoute 53に作成」ボタンで自動作成できます。</p>
            </div>
            
            <div class="step">
                <div class="step-number">8</div>
                <h3>Eメール検証の場合</h3>
                <p>ドメイン管理者のメールアドレス宛に検証メールが送信されます。メール内のリンクをクリックして承認します。</p>
            </div>
            
            <div class="step">
                <div class="step-number">9</div>
                <h3>検証の確認</h3>
                <p>検証が完了すると、証明書のステータスが「発行済み」に変わります（検証には数分から数時間かかる場合があります）。</p>
            </div>
        </div>
        
        <h2>証明書の利用</h2>
        
        <div class="diagram">
            <div class="aws-service">CloudFront</div>
            <div class="aws-arrow">←→</div>
            <div class="aws-service">ACM</div>
            <div class="aws-arrow">←→</div>
            <div class="aws-service">ELB</div>
            <div class="aws-arrow">←→</div>
            <div class="aws-service">API Gateway</div>
        </div>
        
        <p>発行された証明書は、以下のAWSサービスで利用できます：</p>
        <ul>
            <li>Elastic Load Balancing (ELB)</li>
            <li>Amazon CloudFront</li>
            <li>Amazon API Gateway</li>
            <li>AWS Elastic Beanstalk</li>
            <li>Amazon AppSync</li>
        </ul>
        
        <div class="note">
            <p><strong>注意：</strong> ACMで発行した証明書は、上記のAWSサービスでのみ使用可能です。EC2インスタンスに直接インストールすることはできません。</p>
        </div>
        
        <h2>SANを利用する利点</h2>
        
        <div class="benefits-grid">
            <div class="benefit-card">
                <h4>コスト削減</h4>
                <p>複数の証明書ではなく、1つの証明書で複数のドメインをカバーできるため、コストを抑えられます。</p>
            </div>
            
            <div class="benefit-card">
                <h4>管理の簡素化</h4>
                <p>複数の証明書を個別に管理する手間が省け、更新も一括で行えます。</p>
            </div>
            
            <div class="benefit-card">
                <h4>自動更新</h4>
                <p>DNS検証を選択した場合、ACMは証明書を自動的に更新します（有効期限は13ヶ月）。</p>
            </div>
            
            <div class="benefit-card">
                <h4>セキュリティ強化</h4>
                <p>すべてのドメインとサブドメインがSSL/TLS暗号化でセキュアになります。</p>
            </div>
        </div>
        
        <div class="troubleshooting">
            <h2>よくあるトラブルと解決策</h2>
            <p><strong>1. 検証が完了しない</strong><br>
            DNS設定が正しく行われているか確認してください。Route 53以外のDNSサービスを使用している場合、反映に時間がかかることがあります。</p>
            
            <p><strong>2. 証明書が「保留中」のままになる</strong><br>
            検証メールが迷惑メールフォルダに入っていないか確認してください。また、正しいメールアドレスに送信されているか確認してください。</p>
            
            <p><strong>3. 証明書がサービスで使用できない</strong><br>
            証明書とサービスが同じリージョンにあるか確認してください。CloudFrontの場合は、証明書が米国東部（バージニア北部）リージョンにある必要があります。</p>
        </div>
        
        <div class="conclusion">
            <h2>まとめ</h2>
            <p>AWS ACMを使用してSAN対応のSSL/TLS証明書を取得することで、複数のドメインやサブドメインを効率的に保護できます。この方法により、管理の手間を減らしつつ、ウェブサイトやアプリケーションのセキュリティを向上させることができます。</p>
            
            <p>初心者にとっても、ACMのシンプルなインターフェースとガイド付きの手順により、SSL/TLS証明書の取得と管理が容易になります。また、DNS検証を選択すれば、証明書の自動更新も可能で、有効期限切れによるセキュリティリスクも軽減できます。</p>
        </div>
    </div>
</body>
</html>
